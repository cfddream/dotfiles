# https://github.com/thoughtbot/dotfiles
# https://github.com/tejr/dotfiles/blob/master/tmux/tmux.conf
# https://gist.github.com/MohamedAlaa/2961058

# 基本配置
set -g default-terminal 'screen-256color'
set -g terminal-overrides 'xterm*:smcup@:rmcup@'
set -g history-limit 10000
set -g escape-time 0
set -g display-time 3000

# 默认Shell
set-option -g default-command "reattach-to-user-namespace -l zsh"

bind R source-file ~/.tmux.conf

# 设置命令前缀
unbind C-b
set -g prefix C-f

# Pane 操作
setw -g mode-keys vi
bind h select-pane -L
bind j select-pane -D
bind k select-pane -U
bind l select-pane -R
bind-key -r C-h select-window -t :-
bind-key -r C-l select-window -t :+
bind-key C-a last-pane

# v:水平分割 s:垂直分割
unbind '"'
bind v split-window -v
unbind %
bind s split-window -h

# 窗口索引从1开始
set -g base-index 1

# 如果有窗口被关掉，则刷新窗口索引
set -g renumber-windows on

# 新建和关闭窗口
bind n new-window
bind d kill-window

# 窗口选择
bind r last-window
bind Enter choose-window
bind J next-window
bind K previous-window

# /:搜索
bind / command-prompt "find-window '%%'"

# 鼠标控制
set -g mode-mouse on
set -g mouse-resize-pane on
set -g mouse-select-pane on
set -g mouse-select-window on

# c:解脱当前用户
unbind c
bind c detach-client

# C-c:杀死当前会话
bind C-c kill-session

# 进入copy-mode
bind y copy-mode
# v:开始标记
bind -t vi-copy v begin-selection
# y:进行复制
bind -t vi-copy y copy-selection
# y:复制到系统剪贴板
bind -t vi-copy y copy-pipe "reattach-to-user-namespace pbcopy"
# Enter:复制到系统剪贴板
unbind -t vi-copy Enter
bind -t vi-copy Enter copy-pipe "reattach-to-user-namespace pbcopy"
# Escape:取消
bind -t vi-copy Escape cancel
# p:进行粘贴
bind p paste-buffer

### Status bar
set -g status-utf8 on
set -g status-justify centre
set -g status-left '[#S]'
set -g status-right '[#H] #(date +"%F %T")'

### colourscheme solarized
# reference: https://github.com/seebi/tmux-colors-solarized 

# default statusbar colors
set-option -g status-bg colour235 #base02
set-option -g status-fg colour136 #yellow
set-option -g status-attr default

# default window title colors
set-window-option -g window-status-fg colour244
set-window-option -g window-status-bg default
#set-window-option -g window-status-attr dim

# active window title colors
set-window-option -g window-status-current-fg colour166 #orange
set-window-option -g window-status-current-bg default
#set-window-option -g window-status-current-attr bright

# pane border
set-option -g pane-border-fg colour235 #base02
set-option -g pane-active-border-fg colour240 #base01

# message text
set-option -g message-bg colour235 #base02
set-option -g message-fg colour166 #orange

# pane number display
set-option -g display-panes-active-colour colour33 #blue
set-option -g display-panes-colour colour166 #orange

# clock
set-window-option -g clock-mode-colour colour64 #green

### platform-specific config
if-shell '[ $(uname) = "Linux" ] && [ -f ~/.tmux_linux.conf ]' 'source ~/.tmux_linux.conf'
if-shell '[ $(uname) = "Darwin" ] && [ -f ~/.tmux_osx.conf ]' 'source ~/.tmux_osx.conf'


## act like GNU screen
#unbind C-b
#set -g prefix C-a
#bind a send-prefix
#bind C-a last-window
#
## Vim-like pane switching
#setw -g mode-keys vi
#bind h select-pane -L
#bind j select-pane -D
#bind k select-pane -U
#bind l select-pane -R
#
## Bindings
#bind '/' confirm-before "kill-window"
#bind '\' confirm-before "kill-server"
#bind '_' split-window -v
#bind '|' split-window -h
#bind -r C-h select-window -t :-
#bind -r C-l select-window -t :+
#bind Tab last-pane
#
## Vim-like pane resize
#bind -r '+' resize-pane -U 5
#bind -r '-' resize-pane -D 5
#bind -r '<' resize-pane -L 5
#bind -r '>' resize-pane -R 5
#
## Allow repeats for next/prev window
#bind -r n next-window
#bind -r p previous-window
#
## enable copy-paste http://goo.gl/DN82E
##set -g default-command 'reattach-to-user-namespace -l zsh'
#
######## Copy & Pasting ################
## copying and pasting
#bind [ copy-mode
#bind ] paste-buffer -s \015
#
## list all paste buffers (default key is '#')
#bind b list-buffers
#
## choose buffer to paste interactively (default key was '=')
#bind p choose-buffer
#
## delete the most recently copied buffer of text (default key was '-')
#bind x delete-buffer
#
#bind -t vi-copy v begin-selection
#bind -t vi-copy y copy-selection
#bind -t vi-copy Escape cancel
#########################################
#
## Window & Activity
#setw -g utf8 on
#set -g mode-mouse on
#set -g mouse-resize-pane on
#set -g mouse-select-pane on
#set -g mouse-select-window on
#setw -g monitor-activity on
#setw -g window-status-activity-attr none
#set -g renumber-windows on
#
## Join and break panes
#bind J choose-window "join-pane -h -s '%%'"
#bind B break-pane -d
#
## Choose only sessions, don't care about windows
#bind s choose-session
#
## Status bar
#set -g status-utf8 on
#set -g status-justify centre
#set -g status-left '[#S]'
#set -g status-right '[#H] #(date +"%F %T")'
#
## Miscellaneous
#set -g base-index 1
#set -g display-time 3000
#set -g escape-time 0
#set -g history-limit 20000
#set -g set-clipboard off
#setw -g aggressive-resize on
#setw -g automatic-rename on
#
## Formatting
#setw -g window-status-format "#I:#W#F"
#
## Colors
#set -g default-terminal 'screen-256color'
#set -g terminal-overrides 'xterm*:smcup@:rmcup@'
#set -g message-bg colour18
#set -g message-fg colour231
#set -g pane-active-border-fg colour237
#set -g pane-border-fg colour237
##set -g status-bg colour237
##set -g status-fg colour248
#set -g status-bg '#666666'
#set -g status-fg '#aaaaaa'
#setw -g mode-bg colour18
#setw -g mode-fg colour231
#setw -g window-status-attr none
#setw -g window-status-fg colour16
#setw -g window-status-current-attr none
#setw -g window-status-current-fg colour231
#setw -g window-status-bell-attr none
#setw -g window-status-bell-bg colour9
